(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();const C=navigator.userAgent;console.log(C);const b=C.toLowerCase().includes("chrom");b||alert(`Your browser might NOT support all features of this app.
A chrome based browser like Chrome or Helium is recommended.`);const E=`<div class="text-wrapper">
	<div class='text-extra-boarder'>
		<textarea class="text" readonly>{{ text }}</textarea>
	</div>
</div>
<div class="connecters"></div>
<div class="children"></div>`;class W{orthogonalPath(t,e,s=8){const r=e.x-t.x,i=e.y-t.y,a=i===0?1:Math.sign(i),n=Math.min(Math.abs(r)/2,Math.abs(i)/2,s);if(n<1)return`M ${t.x} ${t.y}
					L ${e.x} ${e.y}`;const o=t.x+r/2;return`
			M ${t.x} ${t.y}
			H ${o-n}
			Q ${o} ${t.y}
			${o} ${t.y+a*n}
			V ${e.y-a*n}
			Q ${o} ${e.y}
			${o+n} ${e.y}
			H ${e.x}
		`}getPoint(t,e){if(Math.abs(e.x)>1||Math.abs(e.y)>1)throw new Error("Invalid input, point x & y must be between -1 and 1 (inclusive), was: ("+e.x+" , "+e.y+")");t.getBoundingClientRect(),this.getSvgOffset();var s=t.offsetLeft+t.offsetWidth/2;s+=t.offsetWidth/2*e.x;var r=t.offsetTop+t.offsetHeight/2;return r+=t.offsetHeight/2*e.y,{x:s,y:r}}getSvgOffset(){const t=this.svg.getBoundingClientRect();return{x:t.left,y:t.top}}addParent(t){t.appendChild(this.svg)}removeParent(){this.svg.remove()}update(){this.path.remove(),this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.path.setAttribute("fill","none"),this.path.setAttribute("stroke","#aaa"),this.path.setAttribute("stroke-width","2"),this.path.setAttribute("marker-end","url(#arrow)"),this.path.setAttribute("d",this.orthogonalPath(this.getPoint(this.from,{x:1,y:0}),this.getPoint(this.to,{x:-1,y:0}))),this.svg.appendChild(this.path),this.updateSVG(this.svg,this.path)}updateSVG(t,e){const s=e.getBBox();t.setAttribute("width",s.width+"px"),t.setAttribute("height",s.height+30+"px"),t.setAttribute("viewBox",`${s.x} ${s.y} ${s.width} ${s.height+15}`);var r=this.from.offsetTop+this.from.offsetHeight/2-8;r<this.to.offsetTop+this.to.offsetHeight/2?t.style.top=r+"px":t.style.top=r-s.height+"px"}constructor(t,e,s){this.from=t,this.to=e,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="absolute",this.svg.innerHTML=`
			<defs>
				<marker id="arrow" viewBox="0 0 10 10"
				refX="10" refY="5"
				markerWidth="6" markerHeight="6"
				orient="auto">
				<path d="M 0 0 L 10 5 L 0 10 z" fill="#aaa"/>
				</marker>
			</defs>
		`,this.path=document.createElementNS("http://www.w3.org/2000/svg","path"),this.update(),this.addParent(s)}from;to;svg;path}const k=50;class d{addToCanvas(){this.parent==null&&this.canvas.insertAdjacentElement("beforeend",this.wrapper)}updateConnecter(){this.parentConnector!=null&&this.parentConnector.update(),this.children.forEach(t=>{t.updateConnecter()})}updateHeight(){this.parentConnector!=null?this.updateConnecter():this.children.forEach(t=>{t.updateConnecter()}),this.parent!=null&&this.parent.updateHeight()}checkHeightUpdate=()=>{const t=this.textArea.offsetHeight;t!=this.lastTextAreaHeight&&(this.lastTextAreaHeight=t,this.updateHeight())};updateChildWidth(){if(this.parent!==null){this.parent.updateChildWidth();return}for(var t=[],e=0;;){const i=this.getWidthAtDepth(e);if(i==null)break;var s=0;i.forEach(a=>{a>s&&(s=a)}),t.push(s),e++}const r=t[0];r!==void 0&&this.updateWidth(r,t.slice(1))}getWidthAtDepth(t){if(t==0)return[this.getWidth()];if(this.children!=null){var e=[];if(this.children.forEach(s=>{var r=s.getWidthAtDepth(t-1);r!==void 0&&r.forEach(i=>{e.push(i)})}),e.length!=0)return e}}updateWidth(t,e){if(this.connecterArea.style.width=t-this.getWidth()+k+"px",e.length!==0){const s=e[0];s!==void 0&&this.children.forEach(r=>{r.updateWidth(s,e.slice(1))})}}checkWidthUpdate=()=>{this.textArea.offsetWidth!==this.lastTextAreaWidth&&(this.parent!==null?this.parent.updateChildWidth():this.updateChildWidth(),this.lastTextAreaWidth=this.textArea.offsetWidth)};save(){return JSON.parse('{			"name":"test"		}')}load(t){throw new Error("Method not implemented.")}setParent(t){this.parent=t,this.wrapper.style.position="initial",this.parentConnector=new W(this.parent.getTextWrapper(),this.textWrapper,this.parent.getConnecterArea()),this.updateConnecter()}removeParent(t){this.wrapper.style.position="absolute",this.parent=null,this.addToCanvas(),this.parentConnector!=null&&(this.parentConnector.removeParent(),this.parentConnector=null),this.updateConnecter()}addChild(t){this.childArea.insertBefore(t.getWrapper(),null),this.children.push(t),t.setParent(this),this.updateChildWidth(),this.updateConnecter()}removeChild(t){if(this.children.includes(t)){t.removeParent(this);var e=this.children.indexOf(t);this.children.splice(e,1),this.updateConnecter()}}dblClick=t=>{t.preventDefault();const e=Number(this.textArea.dataset.caret??0);this.textArea.readOnly=!1,this.textArea.focus(),this.textArea.setSelectionRange(e,e),this.textArea.classList.toggle("selection-disabled",!1),this.textArea.addEventListener("focusout",this.lock),this.textArea.removeEventListener("dblclick",this.dblClick)};lock=t=>{this.textArea.removeEventListener("focusout",this.lock),this.textArea.addEventListener("dblclick",this.dblClick),this.textArea.readOnly=!0,this.textArea.blur(),this.wrapper.focus(),this.textArea.classList.toggle("selection-disabled",!0),console.log(this.textArea.value)};trackCaretPosition=t=>{this.textArea.readOnly&&(this.textArea.dataset.caret=String(this.textArea.selectionStart??0))};startDrag=t=>{document.activeElement===this.textArea||this.parent!==null||(this.Xmouse=t.clientX,this.Ymouse=t.clientY,document.addEventListener("mouseup",this.stopDrag),document.addEventListener("mousemove",this.elementDrag))};elementDrag=t=>{t.preventDefault();var e=this.Xmouse-t.clientX,s=this.Ymouse-t.clientY;this.Xmouse=t.clientX,this.Ymouse=t.clientY,this.Xpos-=e,this.Ypos-=s,this.setPos(this.Xpos,this.Ypos)};stopDrag=t=>{document.removeEventListener("mouseup",this.stopDrag),document.removeEventListener("mousemove",this.elementDrag),this.textArea.blur(),this.wrapper.focus()};setPos(t,e){this.wrapper.style.left=t+"px",this.wrapper.style.top=e+"px"}constructor(t,e){this.parent=null,this.parentConnector=null,this.canvas=t;var s,r;if(e!==void 0&&(s=e.text,r=e.pos),s==null&&(s=""),this.Xpos=0,this.Ypos=0,r!==void 0)this.Xpos=r.x,this.Ypos=r.y;else{var i=window.innerWidth/2,a=window.innerHeight/2,n=t.offsetLeft,o=t.offsetTop;this.Xpos=i-n,this.Ypos=a-o}this.children=[];var y=E.replace("{{ text }}",s);this.Xmouse=0,this.Ymouse=0,this.wrapper=document.createElement("div"),this.wrapper.setAttribute("class","tree-node"),this.setPos(this.Xpos,this.Ypos),this.wrapper.innerHTML=y,this.wrapper.style.position="absolute";const u=this.wrapper.getElementsByTagName("textarea")[0];if(u!==void 0)this.textArea=u;else throw new Error("Error: textarea element not found");const f=this.wrapper.getElementsByClassName("children")[0];if(f!==void 0)this.childArea=f;else throw new Error("Children class not found");this.textArea.addEventListener("dblclick",this.dblClick),this.textArea.addEventListener("mousedown",this.trackCaretPosition),this.textArea.classList.toggle("selection-disabled",!0),this.lastTextAreaWidth=this.textArea.offsetWidth,this.lastTextAreaHeight=this.textArea.offsetHeight,this.textArea.addEventListener("input",this.checkWidthUpdate),this.textArea.addEventListener("input",this.checkHeightUpdate);const x=this.wrapper.getElementsByClassName("text-wrapper")[0];if(x!=null)this.textWrapper=x;else throw new Error("text-wrapper class not found");const g=this.wrapper.getElementsByClassName("text-extra-boarder")[0];if(g!=null)this.textExtraBoarder=g;else throw new Error("text-extra-boarder class not found");this.addToCanvas();const v=this.wrapper.getElementsByClassName("connecters")[0];if(v!=null)this.connecterArea=v;else throw new Error("Connecters class not found");this.wrapper.addEventListener("mousedown",this.startDrag)}getWrapper(){return this.wrapper}getTextWrapper(){return this.textWrapper}getConnecterArea(){return this.connecterArea}getWidth(){var t=parseInt(window.getComputedStyle(this.textExtraBoarder,null).getPropertyValue("padding-left"));return t*=2,this.textArea.offsetWidth+t}lastTextAreaWidth;lastTextAreaHeight;connecterArea;textExtraBoarder;canvas;wrapper;textWrapper;textArea;childArea;children;parent;Xmouse;Ymouse;Xpos;Ypos;parentConnector}const h=document.getElementById("canvas");if(h!==null){var l=new d(h,{text:"1asdfasdfadsf",pos:{x:50,y:100}}),m=new d(h,{text:"2"}),p=new d(h,{text:"3"}),w=new d(h),L=new d(h,{text:"4"}),H=new d(h,{text:"5"});l.addChild(m),l.addChild(p),p.addChild(w),m.addChild(L),w.addChild(H);for(var A=0;A<5;A++){var T=new d(h);l.addChild(T)}l.removeChild(p)}
